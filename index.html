<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ğŸ„ åœ£è¯é­”æ³• AI</title>
    <style>
        body { margin: 0; background: #000; color: white; overflow: hidden; font-family: sans-serif; }
        /* å¯åŠ¨æŒ‰é’®ï¼šè§£å†³æµè§ˆå™¨æ‹¦æˆªé—®é¢˜çš„å…³é”® */
        #start-overlay {
            position: fixed; inset: 0; background: radial-gradient(circle, #1a1a1a, #000);
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10000;
        }
        button {
            padding: 15px 40px; font-size: 18px; background: #00ffcc; color: #000;
            border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 0 20px #00ffcc;
        }
        #video-input { position: fixed; bottom: 10px; right: 10px; width: 80px; height: 60px; border-radius: 5px; transform: scaleX(-1); z-index: 1; border: 1px solid #444; }
        #status { margin-top: 20px; color: #888; font-size: 12px; }
    </style>
</head>
<body>

<div id="start-overlay">
    <h1 style="margin-bottom:30px">åœ£è¯ç²’å­é­”æ³•</h1>
    <button id="launch-btn">å¼€å¯æ‘„åƒå¤´å¹¶è¿›å…¥</button>
    <div id="status">ç‚¹å‡»æŒ‰é’®åè¯·å…è®¸æ‘„åƒå¤´æƒé™</div>
</div>

<video id="video-input" playsinline webkit-playsinline muted></video>

<script src="https://cdn.staticfile.org/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
let scene, camera, renderer, particles, particleMaterial;
let handScale = 1.0;

// åˆå§‹åŒ–åœºæ™¯
function initThree() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 5;
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const geo = new THREE.BufferGeometry();
    const pos = [];
    for(let i=0; i<10000; i++) {
        let y = Math.random() * 4 - 2;
        let r = (2 - y) * 0.4;
        let a = Math.random() * Math.PI * 2;
        pos.push(Math.cos(a)*r*Math.random(), y, Math.sin(a)*r*Math.random());
    }
    geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
    particleMaterial = new THREE.PointsMaterial({ color: 0x00ffcc, size: 0.02, transparent: true, blending: THREE.AdditiveBlending });
    particles = new THREE.Points(geo, particleMaterial);
    scene.add(particles);
}

// åˆå§‹åŒ– AI
async function initAI() {
    const hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
    hands.setOptions({maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.5});
    hands.onResults(res => {
        if(res.multiHandLandmarks && res.multiHandLandmarks[0]) {
            const lm = res.multiHandLandmarks[0];
            const d = Math.hypot(lm[8].x - lm[4].x, lm[8].y - lm[4].y);
            handScale = d * 10;
        }
    });

    const cam = new Camera(document.getElementById('video-input'), {
        onFrame: async () => { await hands.send({image: document.getElementById('video-input')}); },
        width: 480, height: 360
    });
    return cam.start();
}

document.getElementById('launch-btn').onclick = async () => {
    document.getElementById('launch-btn').innerText = "åŠ è½½ä¸­...";
    try {
        initThree();
        await initAI();
        document.getElementById('start-overlay').style.display = 'none';
        animate();
    } catch (e) {
        alert("å¼€å¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‘„åƒå¤´æƒé™æˆ–å…³é—­æ‹¦æˆªæ’ä»¶");
    }
};

function animate() {
    requestAnimationFrame(animate);
    particles.rotation.y += 0.005;
    particles.scale.setScalar(THREE.MathUtils.lerp(particles.scale.x, handScale, 0.1));
    renderer.render(scene, camera);
}
</script>
</body>
</html>

